# CSV Chunker Pro - Complete Project Documentation

## Table of Contents
1. [Project Overview](#1-project-overview)
2. [Project Structure](#2-project-structure)
3. [File-by-File Documentation](#3-file-by-file-documentation)
4. [Setup & Installation](#4-setup--installation)
5. [How to Run](#5-how-to-run)
6. [Code Flow & Logic](#6-code-flow--logic)
7. [Debugging Guide](#7-debugging-guide)
8. [Error Handling Matrix](#8-error-handling-matrix)
9. [API Documentation](#9-api-documentation)
10. [Database Schema](#10-database-schema)
11. [Frontend Components](#11-frontend-components)
12. [Configuration Files](#12-configuration-files)

---

## 1. Project Overview

### 🎯 Application Purpose
**CSV Chunker Pro** is a comprehensive web application that processes CSV files through an intelligent chunking, embedding, and retrieval pipeline. It transforms raw CSV data into searchable vector embeddings, enabling semantic search and data analysis capabilities.

**Key Capabilities:**
- **CSV Processing**: Upload and preprocess CSV files with data validation and cleaning
- **Smart Chunking**: Break down data using 4 different methods (Fixed, Recursive, Semantic, Document-based)
- **Vector Embeddings**: Generate semantic embeddings using state-of-the-art models
- **Vector Storage**: Store embeddings in ChromaDB or FAISS databases
- **Semantic Search**: Query data using natural language with similarity matching
- **File Downloads**: Export processed chunks, embeddings, and metadata
- **Real-time UI**: Dynamic progress tracking and live processing updates

### 🛠️ Technology Stack

#### **Frontend**
- **HTML5**: Modern semantic markup with responsive design
- **CSS3**: Flexbox layouts, CSS Grid, custom properties, animations
- **Vanilla JavaScript**: ES6+ features, async/await, fetch API, DOM manipulation
- **No Framework**: Pure JavaScript for maximum performance and minimal dependencies

#### **Backend**
- **Python 3.8+**: Core programming language
- **FastAPI**: Modern, fast web framework for building APIs
- **Uvicorn**: ASGI server for running FastAPI applications
- **Pydantic**: Data validation and serialization using Python type hints

#### **Data Processing**
- **Pandas**: Data manipulation and analysis
- **NumPy**: Numerical computing and array operations
- **Scikit-learn**: Machine learning utilities (KMeans clustering)
- **NLTK**: Natural language processing toolkit
- **spaCy**: Advanced NLP library for text processing

#### **Text Processing & Embeddings**
- **Sentence Transformers**: Generate semantic embeddings
- **LangChain**: Text splitting and chunking utilities
- **Tiktoken**: Token counting for text processing
- **BeautifulSoup4**: HTML/XML parsing for text cleaning

#### **Vector Databases**
- **ChromaDB**: Easy-to-use vector database for development
- **FAISS**: High-performance similarity search and clustering
- **Vector Storage**: Persistent storage with metadata indexing

#### **File Handling**
- **Python-multipart**: Handle multipart form data and file uploads
- **aiofiles**: Asynchronous file operations
- **Base64**: Encode/decode binary data for API transmission

### 🏗️ System Architecture

```
┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐
│   Frontend UI   │    │  FastAPI Backend│    │ Vector Databases│
│                 │    │                 │    │                 │
│ • File Upload   │────│ • API Routes    │────│ • ChromaDB      │
│ • Progress UI   │    │ • Processing    │    │ • FAISS         │
│ • Search Interface    │ • File Handler  │    │ • Metadata      │
│ • Download Links│    │ • Response Builder    │                 │
└─────────────────┘    └─────────────────┘    └─────────────────┘
         │                       │                       │
         │              ┌─────────────────┐              │
         │              │ Processing Core │              │
         │              │                 │              │
         └──────────────│ • Preprocessing │──────────────┘
                        │ • Chunking      │
                        │ • Embedding     │
                        │ • Storing       │
                        │ • Retrieval     │
                        └─────────────────┘
```

#### **Architecture Layers**
1. **Presentation Layer**: HTML/CSS/JavaScript frontend with responsive UI
2. **API Layer**: FastAPI with RESTful endpoints and automatic documentation
3. **Service Layer**: Business logic orchestration and file management
4. **Core Processing Layer**: Specialized modules for each processing step
5. **Data Layer**: Vector databases and file storage systems

### ✨ Key Features

#### **🚀 Multi-Layer Processing**
- **Layer 1 (Fast Mode)**: Optimized defaults for quick processing
- **Layer 2 (Config Mode)**: Medium customization with user preferences
- **Layer 3 (Deep Mode)**: Full control over all processing parameters
- **Unified API**: Single endpoint for enterprise integration

#### **📊 Advanced Chunking Methods**
- **Fixed Size**: Split data into equal-sized chunks
- **Recursive**: Intelligent splitting with context preservation
- **Semantic**: AI-powered clustering using K-means algorithm
- **Document-based**: Chunk by document structure and key columns

#### **🧠 Embedding Models**
- **all-MiniLM-L6-v2**: Fast, lightweight model (384 dimensions)
- **BAAI/bge-small-en-v1.5**: Higher accuracy model for complex data
- **Batch Processing**: Configurable batch sizes for optimal performance

#### **🔍 Search Capabilities**
- **Semantic Search**: Natural language queries with context understanding
- **Multiple Metrics**: Cosine similarity, dot product, Euclidean distance
- **Top-K Results**: Configurable number of results with relevance scoring
- **Real-time Search**: Instant results with expandable interface

#### **📁 File Management**
- **Multiple Formats**: Export chunks (CSV), embeddings (JSON), metadata (JSON)
- **Batch Downloads**: Single ZIP file with all processed data
- **Automatic Cleanup**: Configurable file retention and cleanup
- **Secure Storage**: Temporary files with expiration timestamps

#### **🎨 User Interface**
- **Responsive Design**: Works on desktop, tablet, and mobile devices
- **Real-time Progress**: Live updates with step-by-step timing
- **Dynamic Sections**: Expandable search interface and collapsible panels
- **Visual Feedback**: Progress bars, status indicators, and success/error states
- **No-Scroll Design**: Optimized layout that fits in viewport without scrolling

---

## 2. Project Structure

### 📁 Complete Directory Tree

```
csv-chunker-pro/
├── 📁 frontend/                    # Frontend web application
│   ├── index.html                  # Main HTML page
│   ├── script.js                   # Core JavaScript functionality
│   └── styles.css                  # CSS styling and layout
├── 📁 backend/                     # Python backend application
│   ├── __init__.py                 # Python package marker
│   ├── 📁 api/                     # FastAPI application layer
│   │   ├── __init__.py             # Package marker
│   │   ├── main.py                 # FastAPI app entry point
│   │   ├── models.py               # Pydantic data models
│   │   ├── 📁 dependencies/        # Dependency injection
│   │   │   └── __init__.py         # Package marker
│   │   ├── 📁 middleware/          # Custom middleware
│   │   │   └── __init__.py         # Package marker
│   │   └── 📁 routes/              # API endpoint definitions
│   │       ├── __init__.py         # Package marker
│   │       ├── layer_routes.py     # Layer 1/2/3 APIs
│   │       ├── unified_routes.py   # Single unified API
│   │       ├── download_routes.py  # File download endpoints
│   │       └── search_routes.py    # Search functionality
│   ├── 📁 core/                    # Core processing modules
│   │   ├── __init__.py             # Package marker
│   │   ├── preprocessing.py        # Data preprocessing
│   │   ├── chunking.py             # Text chunking algorithms
│   │   ├── embedding.py            # Vector embedding generation
│   │   ├── storing.py              # Vector database storage
│   │   └── retrieval.py            # Similarity search
│   ├── 📁 services/                # Business logic layer
│   │   ├── __init__.py             # Package marker
│   │   ├── pipeline.py             # Processing orchestration
│   │   ├── file_handler.py         # File management
│   │   └── response_builder.py     # API response formatting
│   ├── 📁 utils/                   # Utility functions
│   │   ├── __init__.py             # Package marker
│   │   ├── helpers.py              # Helper functions
│   │   ├── validators.py           # Data validation
│   │   └── base_chunker.py         # Base chunking class
│   └── 📁 storage/                 # File storage directories
│       ├── __init__.py             # Package marker
│       ├── 📁 downloads/           # Generated files storage
│       ├── 📁 temp_files/          # Temporary file storage
│       ├── 📁 .chroma/             # ChromaDB database (auto-created)
│       └── 📁 .faiss/              # FAISS database (auto-created)
├── 📁 config/                      # Configuration files
│   ├── __init__.py                 # Package marker
│   ├── settings.py                 # App configuration & defaults
│   └── logging.py                  # Logging configuration
├── 📁 scripts/                     # Utility scripts
│   ├── start_server.py             # Backend server launcher
│   ├── start_frontend.py           # Frontend server launcher
│   ├── start_full_stack.py         # Full application launcher
│   └── cleanup.py                  # File cleanup utility
├── 📁 logs/                        # Log files (auto-created)
│   └── app.log                     # Application logs
├── requirements.txt                # Python dependencies
├── README.md                       # Basic project information
├── DOCUMENTATION.md                # This comprehensive documentation
├── test_backend.py                 # Backend testing script (optional)
├── test_api.py                     # API testing script (optional)
└── test_complete_system.py         # Full system test (optional)
```

### 📂 Directory Explanations

#### **🌐 frontend/ - Web User Interface**
Contains the complete web application that users interact with:
- **Single Page Application**: No page reloads, dynamic content updates
- **Responsive Design**: Works on all screen sizes and devices
- **Real-time Updates**: Live progress tracking and status updates
- **File Management**: Upload interface and download buttons
- **Search Interface**: Expandable search section with results display

#### **🔧 backend/ - Python Server Application**
The core server application built with FastAPI:

##### **api/ - Web API Layer**
- **main.py**: FastAPI application setup, middleware, exception handling
- **models.py**: Data models for request/response validation
- **routes/**: API endpoints organized by functionality
  - **layer_routes.py**: Three processing layers (Fast/Config/Deep)
  - **unified_routes.py**: Single endpoint for enterprise integration
  - **download_routes.py**: File download and serving endpoints
  - **search_routes.py**: Search and retrieval endpoints

##### **core/ - Processing Engine**
Specialized modules for each step of the data processing pipeline:
- **preprocessing.py**: Data cleaning, validation, type conversion
- **chunking.py**: Four chunking algorithms implementation
- **embedding.py**: Vector embedding generation using AI models
- **storing.py**: Vector database operations (ChromaDB/FAISS)
- **retrieval.py**: Similarity search and ranking algorithms

##### **services/ - Business Logic**
High-level orchestration and management services:
- **pipeline.py**: Coordinates the entire processing workflow
- **file_handler.py**: Manages file uploads, downloads, and cleanup
- **response_builder.py**: Standardizes API response formatting

##### **utils/ - Helper Functions**
Common utilities used across the application:
- **helpers.py**: Configuration loading and general utilities
- **validators.py**: Data validation and error checking
- **base_chunker.py**: Abstract base class for chunking algorithms

##### **storage/ - Data Storage**
File and database storage locations:
- **downloads/**: Generated CSV, JSON, and ZIP files for user download
- **temp_files/**: Temporary files during processing
- **`.chroma/`**: ChromaDB vector database files (auto-created)
- **`.faiss/`**: FAISS index files (auto-created)

#### **⚙️ config/ - Configuration Management**
Application configuration and settings:
- **settings.py**: Central configuration with environment variables
- **logging.py**: Logging setup and formatting

#### **🚀 scripts/ - Utility Scripts**
Scripts for running and managing the application:
- **start_server.py**: Launches FastAPI backend server
- **start_frontend.py**: Serves frontend files with Python HTTP server
- **start_full_stack.py**: Starts both frontend and backend together
- **cleanup.py**: Removes old files and cleans storage directories

### 📊 Directory Size and Complexity

| Directory | Files | Purpose | Complexity |
|-----------|-------|---------|------------|
| `frontend/` | 3 | UI Layer | Medium |
| `backend/api/` | 6+ | API Layer | High |
| `backend/core/` | 5 | Processing | High |
| `backend/services/` | 3 | Business Logic | Medium |
| `backend/utils/` | 3 | Utilities | Low |
| `config/` | 2 | Configuration | Low |
| `scripts/` | 4 | Operations | Low |

### 🔄 Data Flow Between Directories

```
User Upload → frontend/ → backend/api/ → backend/services/ → backend/core/ → backend/storage/
                ↓              ↓              ↓              ↓              ↓
            UI Updates ← API Response ← File Handler ← Pipeline ← Vector DB
```

